(window.webpackJsonp=window.webpackJsonp||[]).push([[181],{743:function(t,s,a){"use strict";a.r(s);var n=a(17),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"什么是路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是路由"}},[t._v("#")]),t._v(" 什么是路由")]),t._v(" "),a("p",[t._v("一个路由就是一个映射关系（key: value），其中 key 为路径，value 可能是 function 或 component")]),t._v(" "),a("p",[t._v("路由(Route)与路由器(Router)的区别：一个路由器管理着多个路由，每一个路由对应一台计算机，你可以把路由想象成是路由器上的一个插口，而路由器上有多个插口，每个插口连接着一台计算机")]),t._v(" "),a("p",[t._v("在 React 应用中，一个 React 应用（单页应用）使用一个路由器即可，所以你可以将整个应用用一个路由器组件包裹，在路由器组件内部的所有路由都归该路由器管理")]),t._v(" "),a("h2",{attrs:{id:"路由的分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由的分类"}},[t._v("#")]),t._v(" 路由的分类")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("后端路由")]),t._v(" "),a("ol",[a("li",[t._v("理解：value 是 function，用来处理客户端提交的请求")]),t._v(" "),a("li",[t._v("注册路由：router.get(path, function(req, res))")]),t._v(" "),a("li",[t._v("工作过程：当 node 接收到一个请求时，根据请求路径找到匹配的路由，调用路由中的函数来处理请求，返回响应数据")])])]),t._v(" "),a("li",[a("p",[t._v("前端路由")]),t._v(" "),a("ol",[a("li",[t._v("理解：浏览器端路由，value 是 component，用于展示页面内容")]),t._v(" "),a("li",[t._v("注册路由：<Route "),a("em",[t._v("path")]),t._v('="/test" '),a("em",[t._v("component")]),t._v("={Test} />")]),t._v(" "),a("li",[t._v("工作过程：当浏览器的 path 变为 /test 时，当前路由组件就会启用 Test 组件")])])])]),t._v(" "),a("h2",{attrs:{id:"history-对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#history-对象"}},[t._v("#")]),t._v(" history 对象")]),t._v(" "),a("p",[t._v("前端路由基石：history 对象")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("分类")]),t._v(" "),a("ol",[a("li",[t._v("browser history: H5 提出的 history 对象，但兼容性相较于 hash history 不是很好")]),t._v(" "),a("li",[t._v("hash history: 兼容性极佳，在 url 中 hash(#) 后面的内容不会发送给服务器，这在解决样式丢失问题会起作用")])])]),t._v(" "),a("li",[a("p",[t._v("React 中 BrowserRouter 和 HashRouter 的区别")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("底层原理不一样")]),t._v(" "),a("p",[t._v("BrowserRouter 使用的是 H5 的 history API，不兼容 IE9 及以下版本")]),t._v(" "),a("p",[t._v("HashRouter 使用的是 URL 的哈希值")])]),t._v(" "),a("li",[a("p",[t._v("path 表现形式不一样")]),t._v(" "),a("p",[t._v("BrowserRouter 的路径中没有 "),a("code",[t._v("#")]),t._v(" ，例如：localhost:3000/demo/test")]),t._v(" "),a("p",[t._v("HashRouter 的路径中包含 "),a("code",[t._v("#")]),t._v(" ，例如：localhost:3000/#/demo/test")])]),t._v(" "),a("li",[a("p",[t._v("刷新后对路由 state 参数的影响")]),t._v(" "),a("p",[t._v("BrowserRouter 没有任何影响，因为 state 保存在 history 对象中")]),t._v(" "),a("p",[t._v("HashRouter 刷新后会导致 state 参数丢失")])])]),t._v(" "),a("p",[t._v("注意⚠️：HashRouter 可以解决一些路径错误相关的问题，主要原因是因为 "),a("code",[t._v("#")]),t._v(" 后面的内容不会发送给服务器")])])]),t._v(" "),a("h2",{attrs:{id:"动态路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态路由"}},[t._v("#")]),t._v(" 动态路由")]),t._v(" "),a("p",[t._v("在 v4 版本之前，React Router 一直使用的是静态路由，直到升级至 v4 版本后改为动态路由。所谓的动态路由就是在"),a("strong",[t._v("应用程序渲染时")]),t._v("发生的路由，而不是在运行应用程序之外的配置或约定中发生的路由")]),t._v(" "),a("h2",{attrs:{id:"解决样式丢失问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决样式丢失问题"}},[t._v("#")]),t._v(" 解决样式丢失问题")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- index.html --\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./css/index.css"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("我们在 index.html 文件中通过 link 标签引入 css 样式文件。")]),t._v(" "),a("p",[t._v("注意⚠️：以上是通过相对路径进行引入的，这在实际开发过程中可能就会造成样式丢失问题，请看下面例子")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Demo 组件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Demo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Component")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n          ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NavLink")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("to")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/lkj/about"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("About")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NavLink")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n          ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n          ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NavLink")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("to")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/lkj/home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Home")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NavLink")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n          ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Route")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/lkj/about"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("component")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("About"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Route")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/lkj/home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("component")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("注意上面的路由，其路径为 "),a("code",[t._v("/lkj/about")]),t._v(" 或 "),a("code",[t._v("/lkj/home")]),t._v("，项目启动首次渲染时肯定是没问题滴，点击导航跳转路径显示对应的组件时也没问题，因为是单页应用，切换路由并不会重新向服务器发送请求。现在问题来了，当我们在此基础上刷新页面时为何页面中的样式会丢失呢？")]),t._v(" "),a("p",[a("strong",[t._v("「分析」")])]),t._v(" "),a("p",[t._v("当你刷新页面时会重新向服务器发送请求，请求路径是 "),a("code",[t._v("http://localhost:3000/lkj/about")]),t._v("。由于是单页应用，服务器只发送给你 index.html 文件，而在该文件中又有请求样式文件的 link 标签，于是又会发送请求，由于 link 标签 "),a("code",[t._v('<link rel="stylesheet" href="./css/index.css">')]),t._v(" 是通过相对路径的方式引入样式文件的，而请求的路径又是 "),a("code",[t._v("http://localhost:3000/lkj/about")]),t._v("，所以最终请求的样式文件路径会变成为 "),a("code",[t._v("http://localhost:3000/lkj/css/index.css")]),t._v("，但是服务器上根本就找不到这种路径所对应的样式文件，自然页面上就不会有样式了。")]),t._v(" "),a("p",[a("strong",[t._v("「解决」")])]),t._v(" "),a("ol",[a("li",[t._v("在 link 标签中的相对路径改成绝对路径 "),a("code",[t._v('<link rel="stylesheet" href="/css/index.css">')]),t._v(" 或 "),a("code",[t._v('<link rel="stylesheet" href="%PUBLIC_URL%/css/index.css">')]),t._v(" 「推荐」")]),t._v(" "),a("li",[t._v("采用 HashRouter 的方式，因为 hash(#) 后面的内容即使你刷新页面也不会作为请求资源发送给服务器")])])])}),[],!1,null,null,null);s.default=e.exports}}]);